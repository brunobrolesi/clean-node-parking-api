// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model ParkingLot {
  id                  String    @id @default(uuid())
  email               String    @db.VarChar(80) @unique
  password            String    @db.VarChar(255)
  name                String    @db.VarChar(80)
  cnpj                String    @db.VarChar(20) 
  address             String    @db.VarChar(100)
  phone               String    @db.VarChar(20)
  status              Status?
  vehicles            Vehicle[]
  tickets             Ticket[]
}

model Status {
  id                    String        @id @default(uuid())
  carCapacity           Int           @default(0)
  motorcycleCapacity    Int           @default(0)
  carOccupancy          Int?          @default(0)
  motorcycleOccupancy   Int?          @default(0)
  parkingLot            ParkingLot    @relation(fields: [parkingLotId], references: [id])
  parkingLotId          String
}

enum VehicleType {
  CAR
  MOTORCYCLE
}

model Vehicle {
  id            String          @id @default(uuid())
  licensePlate  String          @db.VarChar(15)
  type          VehicleType     @default(CAR)
  parkingLot    ParkingLot      @relation(fields: [parkingLotId], references: [id])
  parkingLotId  String
  tickets       Ticket[]
}

model Ticket {
  id            String        @id @default(uuid())
  entryTime     DateTime      @default(now())
  exitTime      DateTime?
  parkingLot    ParkingLot    @relation(fields: [parkingLotId], references: [id])
  parkingLotId  String
  vehicle       Vehicle       @relation(fields: [vehicleId], references: [id])
  vehicleId     String
}
